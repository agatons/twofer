<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>WebAuthn Demo</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="js/webauthn-client.js"></script>
</head>

<body>

<h1>Twofer Demo</h1>

<div>
    <h2>WebAuthn</h2>
    User: test@example.com
    <hr/>
    <button onclick="register()">Register 2-Factor</button>  <span id="regStatus"></span>
    <hr/>
    <button onclick="login()">Login  2-Factor</button>
</div>

<script>

    const aUser = "test@example.com";
    let headers = {
        'user': aUser,
    };

    $(document).ready(function () {
        if (!window.PublicKeyCredential) {
            alert("Error: this browser does not support WebAuthn");
        }
    });

    const webAuthnClient = new WebauthnClient('http://localhost:8080/login', 'http://localhost:8080/register');

    function login() {
        webAuthnClient.login(headers)
    }
    async function register() {
        let success = await webAuthnClient.register(headers);
        if (success) {
            document.getElementById("regStatus").innerText = "You are now registered"
        }
    }

</script>
</body>

</html>